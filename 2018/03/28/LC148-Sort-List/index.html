<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>LC148.Sort List | linlaw Techblog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">LC148.Sort List</h1><a id="logo" href="/.">linlaw Techblog</a><p class="description">Make the change you want to see in the world.</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> home</i></a><a href="/archives/"><i class="fa fa-archive"> archive</i></a><a href="/about/"><i class="fa fa-user"> about</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">LC148.Sort List</h1><div class="post-meta">Mar 28, 2018<span> | </span><span class="category"><a href="/categories/leetcode/">leetcode</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><p>Sort a linked list in O(nlogn) time using constant space complexity.</p>
<p>When it comes to the algorithm that can sort in O(nlogn), it should be Merge sort, Quick sort, Heap sort. The difficult part in this question is the space complexity. If you choose recursive, the program stack will exceed the requirement and might lead to stack overflow. If you use Top-down merge sort, you will use another recursive in your program.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode *next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) : val(x), next(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * https://goo.gl/xgNMT4</span></span><br><span class="line"><span class="comment"> * Merge sort use bottom-up policy, </span></span><br><span class="line"><span class="comment"> * so Space Complexity is O(1)</span></span><br><span class="line"><span class="comment"> * Time Complexity is O(NlgN)</span></span><br><span class="line"><span class="comment"> * stable sort</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function">ListNode *<span class="title">sortList</span><span class="params">(ListNode *head)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(!head || !(head-&gt;next)) <span class="keyword">return</span> head;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//get the linked list's length</span></span><br><span class="line">		ListNode* cur = head;</span><br><span class="line">		<span class="keyword">int</span> length = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(cur)&#123;</span><br><span class="line">			length++;</span><br><span class="line">			cur = cur-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="function">ListNode <span class="title">dummy</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">		dummy.next = head;</span><br><span class="line">		ListNode *left, *right, *tail;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> step = <span class="number">1</span>; step &lt; length; step &lt;&lt;= <span class="number">1</span>)&#123;</span><br><span class="line">			cur = dummy.next;</span><br><span class="line">			tail = &amp;dummy;</span><br><span class="line">			<span class="keyword">while</span>(cur)&#123;</span><br><span class="line">				left = cur;</span><br><span class="line">				right = split(left, step);</span><br><span class="line">				cur = split(right,step);</span><br><span class="line">				tail = merge(left, right, tail);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> dummy.next;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Divide the linked list into two lists,</span></span><br><span class="line"><span class="comment">     * while the first list contains first n ndoes</span></span><br><span class="line"><span class="comment">	 * return the second list's head</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function">ListNode* <span class="title">split</span><span class="params">(ListNode *head, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">		<span class="comment">//if(!head) return NULL;</span></span><br><span class="line">        <span class="comment">//1. point to the position that want to spilt</span></span><br><span class="line">        <span class="comment">//2. separate two linked list, which are from start-&gt;head, second</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; head &amp;&amp; i &lt; n; i++) head = head-&gt;next;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(!head) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">		ListNode *second = head-&gt;next; </span><br><span class="line">		head-&gt;next = <span class="literal">NULL</span>; <span class="comment">//end the list</span></span><br><span class="line">		<span class="keyword">return</span> second;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	  * merge the two sorted linked list l1 and l2,</span></span><br><span class="line"><span class="comment">	  * then append the merged sorted linked list to the node head</span></span><br><span class="line"><span class="comment">	  * return the tail of the merged sorted linked list</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function">ListNode* <span class="title">merge</span><span class="params">(ListNode* l1, ListNode* l2, ListNode* head)</span></span>&#123;</span><br><span class="line">		ListNode *cur = head;</span><br><span class="line">		<span class="keyword">while</span>(l1 &amp;&amp; l2)&#123;</span><br><span class="line">			<span class="keyword">if</span>(l1-&gt;val &gt; l2-&gt;val)&#123;</span><br><span class="line">				cur-&gt;next = l2;</span><br><span class="line">				cur = l2;</span><br><span class="line">				l2 = l2-&gt;next;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				cur-&gt;next = l1;</span><br><span class="line">				cur = l1;</span><br><span class="line">				l1 = l1-&gt;next;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cur-&gt;next = (l1 ? l1 : l2);</span><br><span class="line">		<span class="keyword">while</span>(cur-&gt;next) cur = cur-&gt;next;</span><br><span class="line">		<span class="keyword">return</span> cur;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Reference:<br><a href="https://goo.gl/xgNMT4" target="_blank" rel="noopener">https://goo.gl/xgNMT4</a><br><a href="https://goo.gl/zgWtLT" target="_blank" rel="noopener">https://goo.gl/zgWtLT</a><br><a href="https://goo.gl/JY6o7o" target="_blank" rel="noopener">https://goo.gl/JY6o7o</a></p>
</div><div class="tags"><a href="/tags/leetcode/">leetcode</a><a href="/tags/linked-list/">linked list</a><a href="/tags/merge-sort/">merge sort</a><a href="/tags/space-complexity/">space complexity</a></div><div class="post-nav"><a class="pre" href="/2018/03/29/LC147-Insertion-Sort-List/">LC147. Insertion Sort List</a><a class="next" href="/2018/03/28/Space complexity/">Space complexity between recursion and iterative</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/STL/">STL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithm/">algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/amazon/">amazon</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/facebook/">facebook</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/google/">google</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/leetcode/">leetcode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linkedin/">linkedin</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/microsoft/">microsoft</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/note/">note</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/programming-language/">programming language</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/programming-language/study/">study</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/tutorial/">tutorial</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/uber/">uber</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> tags</i></div><div class="tagcloud"><a href="/tags/Floyd-s-Tortoise-and-Hare-Algorithm/" style="font-size: 15px;">Floyd's Tortoise and Hare Algorithm</a> <a href="/tags/leetcode/" style="font-size: 15px;">leetcode</a> <a href="/tags/easy/" style="font-size: 15px;">easy</a> <a href="/tags/bfs/" style="font-size: 15px;">bfs</a> <a href="/tags/medium/" style="font-size: 15px;">medium</a> <a href="/tags/array/" style="font-size: 15px;">array</a> <a href="/tags/dfs/" style="font-size: 15px;">dfs</a> <a href="/tags/hard/" style="font-size: 15px;">hard</a> <a href="/tags/dp/" style="font-size: 15px;">dp</a> <a href="/tags/string/" style="font-size: 15px;">string</a> <a href="/tags/backtracking/" style="font-size: 15px;">backtracking</a> <a href="/tags/amazon/" style="font-size: 15px;">amazon</a> <a href="/tags/google/" style="font-size: 15px;">google</a> <a href="/tags/facebook/" style="font-size: 15px;">facebook</a> <a href="/tags/microsoft/" style="font-size: 15px;">microsoft</a> <a href="/tags/pure-storage/" style="font-size: 15px;">pure storage</a> <a href="/tags/uber/" style="font-size: 15px;">uber</a> <a href="/tags/hash-table/" style="font-size: 15px;">hash table</a> <a href="/tags/linked-list/" style="font-size: 15px;">linked list</a> <a href="/tags/dynamic-programming/" style="font-size: 15px;">dynamic programming</a> <a href="/tags/sort/" style="font-size: 15px;">sort</a> <a href="/tags/merge-sort/" style="font-size: 15px;">merge sort</a> <a href="/tags/two-pointers/" style="font-size: 15px;">two pointers</a> <a href="/tags/stack/" style="font-size: 15px;">stack</a> <a href="/tags/binary-search/" style="font-size: 15px;">binary search</a> <a href="/tags/two-pointer/" style="font-size: 15px;">two pointer</a> <a href="/tags/topological-sort/" style="font-size: 15px;">topological sort</a> <a href="/tags/graph/" style="font-size: 15px;">graph</a> <a href="/tags/union-find/" style="font-size: 15px;">union find</a> <a href="/tags/apple/" style="font-size: 15px;">apple</a> <a href="/tags/airbnb/" style="font-size: 15px;">airbnb</a> <a href="/tags/design/" style="font-size: 15px;">design</a> <a href="/tags/lyft/" style="font-size: 15px;">lyft</a> <a href="/tags/divide-and-conquer/" style="font-size: 15px;">divide and conquer</a> <a href="/tags/linkedin/" style="font-size: 15px;">linkedin</a> <a href="/tags/math/" style="font-size: 15px;">math</a> <a href="/tags/heap/" style="font-size: 15px;">heap</a> <a href="/tags/tree/" style="font-size: 15px;">tree</a> <a href="/tags/epic-system/" style="font-size: 15px;">epic system</a> <a href="/tags/binary-indexed-tree/" style="font-size: 15px;">binary indexed tree</a> <a href="/tags/permutation/" style="font-size: 15px;">permutation</a> <a href="/tags/brainteaser/" style="font-size: 15px;">brainteaser</a> <a href="/tags/bucket-sort/" style="font-size: 15px;">bucket sort</a> <a href="/tags/greedy/" style="font-size: 15px;">greedy</a> <a href="/tags/peak/" style="font-size: 15px;">peak</a> <a href="/tags/bit-manipulation/" style="font-size: 15px;">bit manipulation</a> <a href="/tags/greddy/" style="font-size: 15px;">greddy</a> <a href="/tags/partition/" style="font-size: 15px;">partition</a> <a href="/tags/subset/" style="font-size: 15px;">subset</a> <a href="/tags/east/" style="font-size: 15px;">east</a> <a href="/tags/yelp/" style="font-size: 15px;">yelp</a> <a href="/tags/snapchat/" style="font-size: 15px;">snapchat</a> <a href="/tags/STL/" style="font-size: 15px;">STL</a> <a href="/tags/C-11/" style="font-size: 15px;">C++ 11</a> <a href="/tags/MSDN/" style="font-size: 15px;">MSDN</a> <a href="/tags/cycle-detection/" style="font-size: 15px;">cycle detection</a> <a href="/tags/algorithm/" style="font-size: 15px;">algorithm</a> <a href="/tags/space-complexity/" style="font-size: 15px;">space complexity</a> <a href="/tags/Tree/" style="font-size: 15px;">Tree</a> <a href="/tags/tree-traversal/" style="font-size: 15px;">tree traversal</a> <a href="/tags/preorder/" style="font-size: 15px;">preorder</a> <a href="/tags/inorder/" style="font-size: 15px;">inorder</a> <a href="/tags/postorder/" style="font-size: 15px;">postorder</a> <a href="/tags/binary-tree/" style="font-size: 15px;">binary tree</a> <a href="/tags/blockchain/" style="font-size: 15px;">blockchain</a> <a href="/tags/refer/" style="font-size: 15px;">refer</a> <a href="/tags/job/" style="font-size: 15px;">job</a> <a href="/tags/web/" style="font-size: 15px;">web</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/github/" style="font-size: 15px;">github</a> <a href="/tags/tutorial/" style="font-size: 15px;">tutorial</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/binary-search-tree/" style="font-size: 15px;">binary search tree</a> <a href="/tags/complete-binary-tree/" style="font-size: 15px;">complete binary tree</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/08/08/207-Course-Schedule/">207. Course Schedule</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/02/402-Remove-K-Digits/">402. Remove K Digits</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/02/767-Reorganize-String/">767. Reorganize String</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/02/452-Minimum-Number-of-Arrows-to-Burst-Balloons/">452. Minimum Number of Arrows to Burst Balloons</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/01/763-Partition-Labels/">763. Partition Labels</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/01/232-Implement-Queue-using-Stacks/">232. Implement Queue using Stacks</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/01/439-Ternary-Expression-Parser/">439. Ternary Expression Parser</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/01/255-Verify-Preorder-Sequence-in-Binary-Search-Tree/">255. Verify Preorder Sequence in Binary Search Tree</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/30/131-Palindrome-Partitioning/">131. Palindrome Partitioning</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/30/77-Combinations/">77. Combinations</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> blogroll</i></div><ul></ul><a href="https://www.linkedin.com/in/lawrence0229/" title="linlaw's Linkedin" target="_blank">linlaw's Linkedin</a><ul></ul><a href="https://github.com/linlaw0229" title="linlaw's Github" target="_blank">linlaw's Github</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2018 <a href="/." rel="nofollow">linlaw Techblog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></div><!--  a(rel='nofollow', target='_blank', href='https://github.com/tufu9441/maupassant-hexo')  Theme|  by
a(rel='nofollow', target='_blank', href='https://github.com/pagecho')  Cho.--></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>